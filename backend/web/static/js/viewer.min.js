!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Viewer=b()}(this,function(){"use strict";function Q(a){return"string"==typeof a}function S(a){return"number"==typeof a&&!R(a)}function T(a){return"undefined"==typeof a}function U(a){return"object"===("undefined"==typeof a?"undefined":P(a))&&null!==a}function W(a){var b,c;if(!U(a))return!1;try{return b=a.constructor,c=b.prototype,b&&c&&V.call(c,"isPrototypeOf")}catch(d){return!1}}function X(a){return"function"==typeof a}function Y(a,b){var c,d;if(a&&X(b))if(Array.isArray(a)||S(a.length))for(c=a.length,d=void 0,d=0;c>d&&b.call(a,a[d],d,a)!==!1;d+=1);else U(a)&&Object.keys(a).forEach(function(c){b.call(a,a[c],c,a)});return a}function Z(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];if(U(a)&&c.length>0){if(Object.assign)return Object.assign.apply(Object,[a].concat(c));c.forEach(function(b){U(b)&&Object.keys(b).forEach(function(c){a[c]=b[c]})})}return a}function $(a,b){for(var c=arguments.length,d=Array(c>2?c-2:0),e=2;c>e;e++)d[e-2]=arguments[e];return function(){for(var c=arguments.length,e=Array(c),f=0;c>f;f++)e[f]=arguments[f];return a.apply(b,d.concat(e))}}function ab(a,b){var c=a.style;Y(b,function(a,b){_.test(b)&&S(a)&&(a+="px"),c[b]=a})}function bb(a){return window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle}function cb(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function db(a,b){if(b){if(S(a.length))return Y(a,function(a){db(a,b)}),void 0;if(a.classList)return a.classList.add(b),void 0;var c=a.className.trim();c?c.indexOf(b)<0&&(a.className=c+" "+b):a.className=b}}function eb(a,b){return b?S(a.length)?(Y(a,function(a){eb(a,b)}),void 0):a.classList?(a.classList.remove(b),void 0):(a.className.indexOf(b)>=0&&(a.className=a.className.replace(b,"")),void 0):void 0}function fb(a,b,c){return b?S(a.length)?(Y(a,function(a){fb(a,b,c)}),void 0):(c?db(a,b):eb(a,b),void 0):void 0}function hb(a){return a.replace(gb,"$1-$2").toLowerCase()}function ib(a,b){return U(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+hb(b))}function jb(a,b,c){U(c)?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+hb(b),c)}function kb(a,b){if(U(a[b]))delete a[b];else if(a.dataset)try{delete a.dataset[b]}catch(c){a.dataset[b]=null}else a.removeAttribute("data-"+hb(b))}function mb(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},e=b.trim().split(lb);return e.length>1?(Y(e,function(b){mb(a,b,c)}),void 0):(X(c.onceListener)&&(c=c.onceListener,delete c.onceListener),a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c),void 0)}function nb(a,b,c){var f,g,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},e=b.trim().split(lb);return e.length>1?(Y(e,function(b){nb(a,b,c)}),void 0):(d.once&&(f=c,g=function h(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return mb(a,b,h),f.apply(a,d)},f.onceListener=g,c=g),a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c),void 0)}function ob(a,b,c){if(a.dispatchEvent){var d=void 0;return X(Event)&&X(CustomEvent)?d=T(c)?new Event(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:c,bubbles:!0,cancelable:!0}):T(c)?(d=document.createEvent("Event"),d.initEvent(b,!0,!0)):(d=document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)}return a.fireEvent?a.fireEvent("on"+b):!0}function pb(a){var b=document.documentElement,c=a.getBoundingClientRect();return{left:c.left+((window.scrollX||b&&b.scrollLeft||0)-(b&&b.clientLeft||0)),top:c.top+((window.scrollY||b&&b.scrollTop||0)-(b&&b.clientTop||0))}}function qb(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function rb(a){var f,b=a.rotate,c=a.scaleX,d=a.scaleY,e=[];return S(b)&&0!==b&&e.push("rotate("+b+"deg)"),S(c)&&1!==c&&e.push("scaleX("+c+")"),S(d)&&1!==d&&e.push("scaleY("+d+")"),f=e.length?e.join(" "):"none",{WebkitTransform:f,msTransform:f,transform:f}}function sb(a){return Q(a)?a.replace(/^.*\//,"").replace(/[?&#].*$/,""):""}function ub(a,b){if(a.naturalWidth&&!tb)return b(a.naturalWidth,a.naturalHeight),void 0;var c=document.createElement("img");c.onload=function(){b(c.width,c.height)},c.src=a.src}function vb(a){switch(a){case 2:return r;case 3:return q;case 4:return p;default:return""}}function wb(a){var b=Z({},a),c=[];return Y(a,function(a,d){delete b[d],Y(b,function(b){var d=Math.abs(a.startX-b.startX),e=Math.abs(a.startY-b.startY),f=Math.abs(a.endX-b.endX),g=Math.abs(a.endY-b.endY),h=Math.sqrt(d*d+e*e),i=Math.sqrt(f*f+g*g),j=(i-h)/h;c.push(j)})}),c.sort(function(a,b){return Math.abs(a)<Math.abs(b)}),c[0]}function xb(a,b){var c=a.pageX,d=a.pageY,e={endX:c,endY:d};return b?e:Z({startX:c,startY:d},e)}function yb(a){var b=0,c=0,d=0;return Y(a,function(a){var e=a.startX,f=a.startY;b+=e,c+=f,d+=1}),b/=d,c/=d,{pageX:b,pageY:c}}function Cb(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function Ib(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var a={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,keyboard:!0,interval:5e3,minWidth:200,minHeight:100,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:"data-big",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null},b='<div class="viewer-container"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><ul class="viewer-toolbar"><li role="button" class="viewer-one-to-one" data-action="one-to-one"></li><li role="button" class="viewer-prev" data-action="prev"></li><li role="button" class="viewer-next" data-action="next"></li><li role="button" class="viewer-rotate-right" data-action="rotate-right"></li></ul><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div role="button" class="viewer-button" data-action="mix"></div><div class="viewer-player"></div></div>',c=window,d=c.PointerEvent,e="viewer",f="move",g="switch",h="zoom",i=e+"-active",j=e+"-close",k=e+"-fade",l=e+"-fixed",m=e+"-fullscreen",n=e+"-fullscreen-exit",o=e+"-hide",p=e+"-hide-md-down",q=e+"-hide-sm-down",r=e+"-hide-xs-down",s=e+"-in",t=e+"-invisible",u=e+"-move",v=e+"-open",w=e+"-show",x=e+"-transition",y="ready",z="show",A="shown",B="hide",C="hidden",D="view",E="viewed",F="click",G="dragstart",H="keydown",I="load",J=d?"pointerdown":"touchstart mousedown",K=d?"pointermove":"mousemove touchmove",L=d?"pointerup pointercancel":"touchend touchcancel mouseup",M="resize",N="transitionend",O="wheel mousewheel DOMMouseScroll",P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},R=Number.isNaN||window.isNaN,V=Object.prototype.hasOwnProperty,_=/^(width|height|left|top|marginLeft|marginTop)$/,gb=/([a-z\d])([A-Z])/g,lb=/\s+/,tb=navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent),zb={render:function(){this.initContainer(),this.initViewer(),this.initList(),this.renderViewer()},initContainer:function(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var a=this.options,b=this.parent,c=void 0;a.inline&&(c={width:Math.max(b.offsetWidth,a.minWidth),height:Math.max(b.offsetHeight,a.minHeight)},this.parentData=c),(this.fulled||!c)&&(c=this.containerData),this.viewerData=Z({},c)},renderViewer:function(){this.options.inline&&!this.fulled&&ab(this.viewer,this.viewerData)},initList:function(){var a=this,b=this.element,c=this.options,d=this.list,e=[];Y(this.images,function(a,b){var d=a.src,f=a.alt||sb(d),g=c.url;d&&(Q(g)?g=a.getAttribute(g):X(g)&&(g=g.call(a,a)),c.navbar||(d=""),e.push("<li><img"+(' src="'+d+'"')+' role="button"'+' data-action="view"'+(' data-index="'+b+'"')+(' data-original-url="'+(g||d)+'"')+(' alt="'+f+'"')+">"+"</li>"))}),d.innerHTML=e.join(""),Y(d.getElementsByTagName("img"),function(b){jb(b,"filled",!0),nb(b,I,$(a.loadImage,a),{once:!0})}),this.items=d.getElementsByTagName("li"),c.transition&&nb(b,E,function(){db(d,x)},{once:!0})},renderList:function(a){var b=a||this.index,c=this.items[b].offsetWidth||30,d=c+1;ab(this.list,{width:d*this.length,marginLeft:(this.viewerData.width-c)/2-d*b})},resetList:function(){qb(this.list),eb(this.list,x),ab({marginLeft:0})},initImage:function(a){var b=this,c=this.options,d=this.image,e=this.viewerData,f=this.footer.offsetHeight,g=e.width,h=Math.max(e.height-f,f),i=this.ImageData||{};ub(d,function(d,e){var l,m,f=d/e,j=g,k=h;h*f>g?k=g/f:j=h*f,j=Math.min(.9*j,d),k=Math.min(.9*k,e),l={naturalWidth:d,naturalHeight:e,aspectRatio:f,ratio:j/d,width:j,height:k,left:(g-j)/2,top:(h-k)/2},m=Z({},l),c.rotatable&&(l.rotate=i.rotate||0,m.rotate=0),c.scalable&&(l.scaleX=i.scaleX||1,l.scaleY=i.scaleY||1,m.scaleX=1,m.scaleY=1),b.imageData=l,b.initialImageData=m,X(a)&&a()})},renderImage:function(a){var b=this.image,c=this.imageData;ab(b,Z({width:c.width,height:c.height,marginLeft:c.left,marginTop:c.top},rb(c))),X(a)&&(this.transitioning?nb(b,N,a,{once:!0}):a())},resetImage:function(){var a=this.image;a&&(a.parentNode.removeChild(a),this.image=null)}},Ab={bind:function(){var a=this.element,b=this.options,c=this.viewer;X(b.view)&&nb(a,D,b.view),X(b.viewed)&&nb(a,E,b.viewed),nb(c,F,this.onClick=$(this.click,this)),nb(c,O,this.onWheel=$(this.wheel,this)),nb(c,G,this.onDragStart=$(this.dragstart,this)),nb(this.canvas,J,this.onPointerDown=$(this.pointerdown,this)),nb(document,K,this.onPointerMove=$(this.pointermove,this)),nb(document,L,this.onPointerUp=$(this.pointerup,this)),nb(document,H,this.onKeyDown=$(this.keydown,this)),nb(window,M,this.onResize=$(this.resize,this))},unbind:function(){var a=this.element,b=this.options,c=this.viewer;X(b.view)&&mb(a,D,b.view),X(b.viewed)&&mb(a,E,b.viewed),mb(c,F,this.onClick),mb(c,O,this.onWheel),mb(c,G,this.onDragStart),mb(this.canvas,J,this.onPointerDown),mb(document,K,this.onPointerMove),mb(document,L,this.onPointerUp),mb(document,H,this.onKeyDown),mb(window,M,this.onResize)}},Bb={click:function(a){var b=a.target,c=this.imageData,d=ib(b,"action");switch(d){case"mix":this.played?this.stop():this.options.inline?this.fulled?this.exit():this.full():this.hide();break;case"view":this.view(ib(b,"index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev();break;case"play":this.play();break;case"next":this.next();break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-c.scaleX||-1);break;case"flip-vertical":this.scaleY(-c.scaleY||-1);break;default:this.played&&this.stop()}},load:function(){var a=this,b=this.options,c=this.image,d=this.index,e=this.viewerData;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1),c&&(eb(c,t),c.style.cssText="width:0;height:0;"+("margin-left:"+e.width/2+"px;")+("margin-top:"+e.height/2+"px;")+"max-width:none!important;"+"visibility:visible;",this.initImage(function(){fb(c,x,b.transition),fb(c,u,b.movable),a.renderImage(function(){a.viewed=!0,ob(a.element,E,{originalImage:a.images[d],index:d,image:c})})}))},loadImage:function(a){var b=a.target,c=b.parentNode,d=c.offsetWidth||30,e=c.offsetHeight||50,f=!!ib(b,"filled");ub(b,function(a,c){var g=a/c,h=d,i=e;e*g>d?f?h=e*g:i=d/g:f?i=d/g:h=e*g,ab(b,{width:h,height:i,marginLeft:(d-h)/2,marginTop:(e-i)/2})})},keydown:function(a){var b=this.options,c=a.keyCode||a.which||a.charCode;if(this.fulled&&b.keyboard)switch(c){case 27:this.played?this.stop():b.inline?this.fulled&&this.exit():this.hide();break;case 32:this.played&&this.stop();break;case 37:this.prev();break;case 38:a.preventDefault(),this.zoom(b.zoomRatio,!0);break;case 39:this.next();break;case 40:a.preventDefault(),this.zoom(-b.zoomRatio,!0);break;case 48:case 49:(a.ctrlKey||a.shiftKey)&&(a.preventDefault(),this.toggle())}},dragstart:function(a){"img"===a.target.tagName.toLowerCase()&&a.preventDefault()},pointerdown:function(a){var d,b=this.options,c=this.pointers;this.viewed&&!this.transitioning&&(a.changedTouches?Y(a.changedTouches,function(a){c[a.identifier]=xb(a)}):c[a.pointerId||0]=xb(a),d=b.movable?f:!1,Object.keys(c).length>1?d=h:"touch"!==a.pointerType&&"touchmove"!==a.type||!this.isSwitchable()||(d=g),this.action=d)},pointermove:function(a){var b=this.options,c=this.pointers,d=this.action,e=this.image;this.viewed&&d&&(a.preventDefault(),a.changedTouches?Y(a.changedTouches,function(a){Z(c[a.identifier],xb(a,!0))}):Z(c[a.pointerId||0],xb(a,!0)),d===f&&b.transition&&cb(e,x)&&eb(e,x),this.change(a))},pointerup:function(a){var b=this.action,c=this.pointers;this.viewed&&(a.changedTouches?Y(a.changedTouches,function(a){delete c[a.identifier]}):delete c[a.pointerId||0],b&&(b===f&&this.options.transition&&db(this.image,x),this.action=!1))},resize:function(){var a=this;if(this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){a.renderImage()}),this.played){if(this.options.fullscreen&&this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement)return this.stop(),void 0;Y(this.player.getElementsByTagName("img"),function(b){nb(b,I,$(a.loadImage,a),{once:!0}),ob(b,I)})}},start:function(a){var b=a.target;"img"===b.tagName.toLowerCase()&&null!=b.getAttribute(this.options.url)&&(this.target=b,this.show())},wheel:function(a){var c,d,b=this;this.viewed&&(a.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),c=Number(this.options.zoomRatio)||.1,d=1,a.deltaY?d=a.deltaY>0?1:-1:a.wheelDelta?d=-a.wheelDelta/120:a.detail&&(d=a.detail>0?1:-1),this.zoom(-d*c,!0,a)))}},Db={show:function(){var d,a=this,b=this.element,c=this.options;return c.inline||this.transitioning?this:(this.ready||this.build(),X(c.show)&&nb(b,z,c.show,{once:!0}),ob(b,z)===!1?this:(this.open(),d=this.viewer,eb(d,o),nb(b,A,function(){a.view(a.target?[].concat(Cb(a.images)).indexOf(a.target):a.index),a.target=!1},{once:!0}),c.transition?(this.transitioning=!0,db(d,x),d.offsetWidth,nb(d,N,$(this.shown,this),{once:!0}),db(d,s)):(db(d,s),this.shown()),this))},hide:function(){var a=this,b=this.element,c=this.options,d=this.viewer;return c.inline||this.transitioning||!this.visible?this:(X(c.hide)&&nb(b,B,c.hide,{once:!0}),ob(b,B)===!1?this:(this.viewed&&c.transition?(this.transitioning=!0,nb(this.image,N,function(){nb(d,N,$(a.hidden,a),{once:!0}),eb(d,s)},{once:!0}),this.zoomTo(0,!1,!1,!0)):(eb(d,s),this.hidden()),this))},view:function(a){var f,g,h,j,k,b=this,c=this.element,d=this.title,e=this.canvas;return a=Number(a)||0,!this.ready||!this.visible||this.played||0>a||a>=this.length||this.viewed&&a===this.index?this:(f=this.items[a],g=f.querySelector("img"),h=ib(g,"originalUrl"),j=g.getAttribute("alt"),k=document.createElement("img"),k.src=h,k.alt=j,ob(c,D,{originalImage:this.images[a],index:a,image:k})===!1?this:(this.image=k,eb(this.items[this.index],i),db(f,i),this.viewed=!1,this.index=a,this.imageData=null,db(k,t),qb(e),e.appendChild(k),this.renderList(),qb(d),nb(c,E,function(){var a=b.imageData;d.textContent=j+" ("+a.naturalWidth+" Ã— "+a.naturalHeight+")"},{once:!0}),k.complete?this.load():(nb(k,I,$(this.load,this),{once:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){eb(k,t),b.timeout=!1},1e3)),this))},prev:function(){return this.view(Math.max(this.index-1,0)),this},next:function(){return this.view(Math.min(this.index+1,this.length-1)),this},move:function(a,b){var c=this.imageData;return this.moveTo(T(a)?a:c.left+Number(a),T(b)?b:c.top+Number(b)),this},moveTo:function(a){var d,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,c=this.imageData;return a=Number(a),b=Number(b),this.viewed&&!this.played&&this.options.movable&&(d=!1,S(a)&&(c.left=a,d=!0),S(b)&&(c.top=b,d=!0),d&&this.renderImage()),this},zoom:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=this.imageData;return a=Number(a),a=0>a?1/(1-a):1+a,this.zoomTo(d.width*a/d.naturalWidth,b,c),this},zoomTo:function(a){var h,i,j,k,l,m,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!1,e=this.options,f=this.pointers,g=this.imageData;return a=Math.max(0,a),S(a)&&this.viewed&&!this.played&&(d||e.zoomable)&&(d||(h=Math.max(.01,e.minZoomRatio),i=Math.min(100,e.maxZoomRatio),a=Math.min(Math.max(a,h),i)),c&&a>.95&&1.05>a&&(a=1),j=g.naturalWidth*a,k=g.naturalHeight*a,c?(l=pb(this.viewer),m=f&&Object.keys(f).length?yb(f):{pageX:c.pageX,pageY:c.pageY},g.left-=(j-g.width)*((m.pageX-l.left-g.left)/g.width),g.top-=(k-g.height)*((m.pageY-l.top-g.top)/g.height)):(g.left-=(j-g.width)/2,g.top-=(k-g.height)/2),g.width=j,g.height=k,g.ratio=a,this.renderImage(),b&&this.tooltip()),this},rotate:function(a){return this.rotateTo((this.imageData.rotate||0)+Number(a)),this},rotateTo:function(a){var b=this.imageData;return a=Number(a),S(a)&&this.viewed&&!this.played&&this.options.rotatable&&(b.rotate=a,this.renderImage()),this},scaleX:function(a){return this.scale(a,this.imageData.scaleY),this},scaleY:function(a){return this.scale(this.imageData.scaleX,a),this},scale:function(a){var d,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,c=this.imageData;return a=Number(a),b=Number(b),this.viewed&&!this.played&&this.options.scalable&&(d=!1,S(a)&&(c.scaleX=a,d=!0),S(b)&&(c.scaleY=b,d=!0),d&&this.renderImage()),this},play:function(){var h,a=this,b=this.options,c=this.player,d=$(this.loadImage,this),e=[],f=0,g=0;return!this.visible||this.played?this:(b.fullscreen&&this.requestFullscreen(),this.played=!0,this.onLoadWhenPlay=d,db(c,w),Y(this.items,function(a,h){var j=a.querySelector("img"),l=document.createElement("img");l.src=ib(j,"originalUrl"),l.alt=j.getAttribute("alt"),f+=1,db(l,k),fb(l,x,b.transition),cb(a,i)&&(db(l,s),g=h),e.push(l),nb(l,I,d,{once:!0}),c.appendChild(l)}),S(b.interval)&&b.interval>0&&(h=function j(){a.playing=setTimeout(function(){eb(e[g],s),g+=1,g=f>g?g:0,db(e[g],s),j()},b.interval)},f>1&&h()),this)},stop:function(){var a=this,b=this.player;return this.played?(this.options.fullscreen&&this.exitFullscreen(),this.played=!1,clearTimeout(this.playing),Y(this.player.getElementsByTagName("img"),function(b){b.complete||mb(b,I,a.onLoadWhenPlay)}),eb(b,w),qb(b),this):this},full:function(){var a=this,b=this.options,c=this.viewer,d=this.image,e=this.list;return!this.visible||this.played||this.fulled||!b.inline?this:(this.fulled=!0,this.open(),db(this.button,n),b.transition&&(eb(d,x),eb(e,x)),db(c,l),c.setAttribute("style",""),ab(c,{zIndex:b.zIndex}),this.initContainer(),this.viewerData=Z({},this.containerData),this.renderList(),this.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){db(d,x),db(e,x)},0)})}),this)},exit:function(){var a=this,b=this.options,c=this.viewer,d=this.image,e=this.list;return this.fulled?(this.fulled=!1,this.close(),eb(this.button,n),b.transition&&(eb(d,x),eb(e,x)),eb(c,l),ab(c,{zIndex:b.zIndexInline}),this.viewerData=Z({},this.parentData),this.renderViewer(),this.renderList(),this.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){db(d,x),db(e,x)},0)})}),this):this},tooltip:function(){var a=this,b=this.options,c=this.tooltipBox,d=this.imageData;return this.viewed&&!this.played&&b.tooltip?(c.textContent=Math.round(100*d.ratio)+"%",this.tooltiping?clearTimeout(this.tooltiping):b.transition?(this.fading&&ob(c,N),db(c,w),db(c,k),db(c,x),c.offsetWidth,db(c,s)):db(c,w),this.tooltiping=setTimeout(function(){b.transition?(nb(c,N,function(){eb(c,w),eb(c,k),eb(c,x),a.fading=!1},{once:!0}),eb(c,s),a.fading=!0):eb(c,w),a.tooltiping=!1},1e3),this):this},toggle:function(){return 1===this.imageData.ratio?this.zoomTo(this.initialImageData.ratio,!0):this.zoomTo(1,!0),this},reset:function(){return this.viewed&&!this.played&&(this.imageData=Z({},this.initialImageData),this.renderImage()),this},update:function(){var c,a=this,b=[];return this.isImg&&!this.element.parentNode?this.destroy():(this.length=this.images.length,this.ready&&(Y(this.items,function(c,d){var e=c.querySelector("img"),f=a.images[d];f?f.src!==e.src&&b.push(d):b.push(d)}),ab(this.list,{width:"auto"}),this.initList(),this.visible&&(this.length?this.viewed&&(c=b.indexOf(this.index),c>=0?(this.viewed=!1,this.view(Math.max(this.index-(c+1),0))):db(this.items[this.index],i)):(this.image=null,this.viewed=!1,this.index=0,this.imageData=null,qb(this.canvas),qb(this.title)))),this)},destroy:function(){var a=this.element;return this.options.inline?this.unbind():(this.visible&&this.unbind(),mb(a,F,this.onStart)),this.unbuild(),kb(a,e),this}},Eb=window,Fb=Eb.document,Gb={open:function(){var a=this.body;db(a,v),a.style.paddingRight=this.scrollbarWidth+"px"},close:function(){var a=this.body;eb(a,v),a.style.paddingRight=0},shown:function(){var a=this.element,b=this.options;this.transitioning=!1,this.fulled=!0,this.visible=!0,this.render(),this.bind(),X(b.shown)&&nb(a,A,b.shown,{once:!0}),ob(a,A)},hidden:function(){var a=this.element,b=this.options;this.transitioning=!1,this.viewed=!1,this.fulled=!1,this.visible=!1,this.unbind(),this.close(),db(this.viewer,o),this.resetList(),this.resetImage(),X(b.hidden)&&nb(a,C,b.hidden,{once:!0}),ob(a,C)},requestFullscreen:function(){if(this.fulled&&!Fb.fullscreenElement&&!Fb.mozFullScreenElement&&!Fb.webkitFullscreenElement&&!Fb.msFullscreenElement){var a=Fb.documentElement;a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){this.fulled&&(Fb.exitFullscreen?Fb.exitFullscreen():Fb.msExitFullscreen?Fb.msExitFullscreen():Fb.mozCancelFullScreen?Fb.mozCancelFullScreen():Fb.webkitExitFullscreen&&Fb.webkitExitFullscreen())},change:function(a){var b=this.pointers,c=b[Object.keys(b)[0]],d=c.endX-c.startX,e=c.endY-c.startY;switch(this.action){case f:this.move(d,e);break;case h:this.zoom(wb(b),!1,a);break;case g:this.action="switched",Math.abs(d)>Math.abs(e)&&(d>1?this.prev():-1>d&&this.next())}Y(b,function(a){a.startX=a.endX,a.startY=a.endY})},isSwitchable:function(){var a=this.imageData,b=this.viewerData;return this.length>1&&a.left>=0&&a.top>=0&&a.width<=b.width&&a.height<=b.height}},Hb=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Jb=void 0,Kb=function(){function c(b){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ib(this,c),!b||1!==b.nodeType)throw new Error("The first argument is required and must be an element.");this.element=b,this.options=Z({},a,W(d)&&d),this.isImg=!1,this.ready=!1,this.visible=!1,this.viewed=!1,this.fulled=!1,this.played=!1,this.wheeling=!1,this.playing=!1,this.fading=!1,this.tooltiping=!1,this.transitioning=!1,this.action=!1,this.target=!1,this.timeout=!1,this.index=0,this.length=0,this.pointers={},this.init()}return Hb(c,[{key:"init",value:function(){var d,f,g,h,i,j,a=this,b=this.element,c=this.options;if(!ib(b,e)){jb(b,e,this),d="img"===b.tagName.toLowerCase(),f=[],g=d?[b]:b.getElementsByTagName("img");for(h in g)1==g[h].nodeType&&null!=g[h].getAttribute(c.url)&&f.push(g[h]);i=f.length,i&&(X(c.ready)&&nb(b,y,c.ready,{once:!0}),T(document.createElement(e).style.transition)&&(c.transition=!1),this.isImg=d,this.length=i,this.count=0,this.images=f,this.body=document.body,this.scrollbarWidth=window.innerWidth-document.body.clientWidth,c.inline?(j=$(this.progress,this),nb(b,y,function(){a.view()},{once:!0}),Y(f,function(a){a.complete?j():nb(a,I,j,{once:!0})})):nb(b,F,this.onStart=$(this.start,this)))}}},{key:"progress",value:function(){this.count+=1,this.count===this.length&&this.build()}},{key:"build",value:function(){var d,f,g,h,i,n,p,q,a=this.options,c=this.element;this.ready||(d=c.parentNode,f=document.createElement("div"),f.innerHTML=b,g=f.querySelector("."+e+"-container"),h=g.querySelector("."+e+"-title"),i=g.querySelector("."+e+"-toolbar"),n=g.querySelector("."+e+"-navbar"),p=g.querySelector("."+e+"-button"),this.parent=d,this.viewer=g,this.title=h,this.toolbar=i,this.navbar=n,this.button=p,this.canvas=g.querySelector("."+e+"-canvas"),this.footer=g.querySelector("."+e+"-footer"),this.tooltipBox=g.querySelector("."+e+"-tooltip"),this.player=g.querySelector("."+e+"-player"),this.list=g.querySelector("."+e+"-list"),db(h,a.title?vb(a.title):o),db(i,a.toolbar?vb(a.toolbar):o),db(n,a.navbar?vb(a.navbar):o),fb(p,o,!a.button),fb(i.querySelector("."+e+"-one-to-one"),t,!a.zoomable),fb(i.querySelectorAll('li[class*="zoom"]'),t,!a.zoomable),fb(i.querySelectorAll('li[class*="flip"]'),t,!a.scalable),a.rotatable||(q=i.querySelectorAll('li[class*="rotate"]'),db(q,t),Y(q,function(a){i.appendChild(a)})),a.inline?(db(p,m),ab(g,{zIndex:a.zIndexInline}),"static"===bb(d).position&&ab(d,{position:"relative"}),d.insertBefore(g,c.nextSibling)):(db(p,j),db(g,l),db(g,k),db(g,o),ab(g,{zIndex:a.zIndex}),document.body.appendChild(g)),a.inline&&(this.render(),this.bind(),this.visible=!0),this.ready=!0,ob(c,y))}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.viewer.parentNode.removeChild(this.viewer))}}],[{key:"noConflict",value:function(){return window.Viewer=Jb,c}},{key:"setDefaults",value:function(b){Z(a,W(b)&&b)}}]),c}();return Z(Kb.prototype,zb,Ab,Bb,Db,Gb),"undefined"!=typeof window&&(Jb=window.Viewer,window.Viewer=Kb),Kb});